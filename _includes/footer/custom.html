<!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const mmmdSwiper = new Swiper("#mmmd-swiper", {
      loop: true,
      spaceBetween: 12,
      slidesPerView: 1,
      centeredSlides: false,
      navigation: {
        nextEl: "#mmmd-next",
        prevEl: "#mmmd-prev",
      },
      pagination: {
        el: "#mmmd-pagination",
        clickable: true,
      },
      breakpoints: {
        720: { slidesPerView: 2 },
        1024: { slidesPerView: 3 },
      }
    });

    // ✅ 1) 중복 슬라이드(duplicate)에서는 lightbox 트리거 제거/차단
    document
      .querySelectorAll("#mmmd-swiper .swiper-slide-duplicate a.glightbox")
      .forEach(a => {
        a.classList.remove("glightbox");
        a.addEventListener("click", (e) => {
          e.preventDefault();
          e.stopImmediatePropagation();
        }, true);
      });

    // ✅ 2) lightbox 인스턴스를 항상 하나만 유지 (중복 생성 방지)
    if (window.mmmdLightbox) {
      window.mmmdLightbox.destroy();
      window.mmmdLightbox = null;
    }

    if (window.GLightbox) {
      window.mmmdLightbox = GLightbox({
        // ✅ duplicate 제외한 슬라이드만 대상으로 잡기
        selector: "#mmmd-swiper .swiper-slide:not(.swiper-slide-duplicate) a.glightbox"
      });
    }

    // abstract click-to-expand (keep)
    document.querySelectorAll(".pub-abstract[data-expandable]").forEach(p => {
      p.addEventListener("click", () => {
        const isCollapsed = p.classList.contains("is-collapsed");
        if (isCollapsed) {
          p.classList.remove("is-collapsed");
          p.classList.add("is-expanded");
        } else {
          p.classList.add("is-collapsed");
          p.classList.remove("is-expanded");
        }
      });
    });
  });
</script>

<!-- end custom footer snippets -->
